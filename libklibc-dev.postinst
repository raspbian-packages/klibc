#!/bin/sh
# From MirOS: contrib/hosted/tg/deb/mksh/debian/pdksh.postinst,v 1.2 2012/06/27 07:16:31 tg Exp $

set -e

# This maintainer script can be called the following ways:
#
# * new-postinst "configure" [$most_recently_configured_version]
# The package is unpacked; all dependencies are unpacked and, when there
# are no circular dependencies, configured.
#
# * old-postinst "abort-upgrade" $new_version
# * conflictors-postinst "abort-remove" "in-favour" $package
#	$new_version
# * postinst "abort-remove"
# * deconfigureds-postinst "abort-deconfigure" "in-favour"
#	$failed_install_package $fip_version ["removing"
#	$conflicting_package $cp_version]
# The package is unpacked; all dependencies are at least Half-Installed,
# previously been configured, and not removed. In some error situations,
# dependencies may not be even fully unpacked.
#
# * postinst "triggered" "${triggers[*]}"
# For trigger-only calls, i.e. if "configure" is not called.

docdir=/usr/share/doc/libklibc-dev
move_docdir() {
	test -d /usr/share/doc/. || return 0
	test -d $docdir && rmdir --ignore-fail-on-non-empty $docdir
	if test -e $docdir; then
		echo >&2 "The old $docdir was locally modified."
		echo >&2 "Saved as $docdir.dpkg-old"
		(mv $docdir $docdir.dpkg-old || :)
	fi
	if test -e $docdir; then
		echo >&2 "FAILED! Remove $docdir manually,"
		echo >&2 "then retry (dpkg -a --configure)."
		exit 1
	fi
	ln -sf libklibc $docdir
}

case $1 in
configure)
	# convert old docdir into a symlink, dpkg won't do that for us
	test -h $docdir || move_docdir
	;;

abort-upgrade|abort-remove|abort-deconfigure)
	;;

triggered)
	;;

*)
	echo >&2 "postinst called with unknown subcommand '$1'"
	exit 1
	;;
esac

# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
